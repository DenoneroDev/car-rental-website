(()=>{"use strict";const e=$("#cars"),t=$("#search"),a=$("#menue-button"),n=$("#menue"),s=$(".number"),i=$("#search-icon"),o=$(".logo"),r=$("#search"),c=$("#header"),l=$("#search-input"),d=$("#loading"),h=$("#error"),p=$("#msg");let u=!1,g=!1,m=!0,f=!0,v=!0;const w=new URL(window.location);let y,b,x=[];function k(){f&&(f=!1,g?(l.focusout(),c.css({"justify-content":"space-around"}),r.css({border:"none"}),i.css({position:"absolute",top:`${i.position().top}px`,left:`${i.position().left}px`}),i.animate({left:"65.4219px"},250,(()=>{i.css({position:"unset"})})),l.animate({width:"0"},250,(()=>{l.hide(),v?$(s).showFlex():a.show(),$(o[0]).show(),g=!1,f=!0}))):(v=$(s[0]).is(":visible"),c.css({"justify-content":"center"}),r.css({border:"1px solid var(--black)"}),l.width(0),l.show(),$(o[0]).hide(),$(s[0]).hide(),a.hide(),l.animate({width:"100%"},250,(()=>{g=!0,f=!0,l.focus()}))))}function C(){if(m)if(m=!1,a.toggleClass("open"),u)n.animate({height:0,padding:0},250,(()=>{n.hide(),u=!1,m=!0}));else{n.showGrid(),n.css("height","auto"),n.css("padding","20px");const e=n.outerHeight();n.height(0),n.animate({height:e},250,(()=>{u=!0,m=!0}))}}function A(e){return e.charAt(0).toUpperCase()+e.slice(1)}$(document).ready((function(){c.height(c.height());for(var e=1;e<=26;e++){var s=175-25*Math.ceil(e/2),o=-.1*e+"s";e%2==0&&(o=-(.1*e+1)+"s");var l=$('<div class="dot"></div>').css("animation-delay",o).css("left",s+"px"),d=$("<div></div>").css("animation-delay",o);l.append(d),$(".loader").append(l)}a.click((()=>C())),t.submit((e=>{e.preventDefault(),w.pathname="/browse",w.searchParams.set("page",1);const t=$("#search-input").val();""!=t?w.searchParams.set("search",t):w.searchParams.delete("search"),location.href=w.href})),$(document).bind("mouseup touchend",(e=>{!u||n.is(e.target)||0!==n.has(e.target).length||0!=a.has(e.target).length||a.is(e.target)||C(),g&&!r.is(e.target)&&0===r.has(e.target).length&&k()})).on("scroll",(()=>{u&&C(),g&&k()})),document.body.clientWidth<=1e3&&i.click((()=>k()))})),Array.prototype.remove=function(e){const t=this.indexOf(e);-1!==t&&this.splice(t,1)},$.fn.showFlex=function(){this.css({display:"flex"})},$.fn.showGrid=function(){this.css({display:"grid"})};$("#menue .contact");const H={lang:null,dropdown:null,section:null,init:()=>{H.section=document.getElementById("language"),H.dropdown=new Choices(H.section,{removeItemButton:!0,duplicateItemsAllowed:!1,editItems:!0,searchEnabled:!1,searchChoices:!1,allowHTML:!0});const e={english:"en",deutsch:"de",čeština:"cs"};H.lang=$("html").attr("lang"),H.dropdown._findAndSelectChoiceByValue(A(function(e,t){for(const a in e)if(e.hasOwnProperty(a)&&e[a]===t)return a;return null}(e,H.lang))),H.section.addEventListener("change",(t=>{Cookies.set("language",e[t.target.value.toLowerCase()]),$("html").attr("lang",e[t.target.value.toLowerCase()]),H.update()})),H.update()},update:()=>{H.lang=$("html").attr("lang"),b.special(),$("[data-langKey]").each(((e,t)=>{const a=b[$(t).data().langkey][H.lang];if("INPUT"===$(t).get(0).nodeName||"TEXTAREA"===$(t).get(0).nodeName)return $(t).attr("placeholder",a);$(t).html(a)}))}};class P{constructor(e){this.car=e,this.lang=$("html").attr("lang")}render(){let e="";for(const t of("en"==this.lang?this.car.keywords:this.car[this.lang]?.keywords)||[])e+=`<p class="popular-car-keyword" title="${A(t)}">${A(t)}</p>\n                        <div class="popular-car-keyword-line"></div>`;return`\n              <a href="/car?id=${this.car._id}">\n                <article class="popular-car">\n                  <img class="popular-car-image" src="${this.car.image}">\n                  <div class="popular-car-content">\n                    <div>\n                      <p class="popular-car-title">${"en"==this.lang?this.car.title:this.car[this.lang].title}</p>\n                      <div class="rating">\n                        <img src="/images/star.png">\n                        <p class="rate">${this.car.rating} / 5</p>\n                        <p class="rates">(${this.car.ratings})</p>\n                      </div>\n                      <div class="popular-car-keywords">\n                      ${e}\n                      </div>\n                    </div>\n                    <p class="popular-car-description">\n                      ${("en"==this.lang?this.car.description:this.car[this.lang]?.description)?.replace(/<[^>]+>/g,"")}\n                    </p>\n                    <div id="bottom">\n                      <p id="info">\n                      ${this.car.rentedUntil?`<img src="/images/info.png" />\n                        ${t=this.car.rentedUntil,moment(t).locale($("html").attr("lang")).format("LL")}`:""}\n                      </p>\n                      <button class="popular-car-button" data-langKey="car-button">Rent this car</button>\n                    </div>\n                  </div>\n                </article>\n                </a>\n        `;var t}}const S={"search-input-placeholder":{en:"Search...",de:"Suchen...",cs:"Hledat..."},"navigation-home":{en:"Home",de:"Startseite",cs:"Domů"},"navigation-browse":{en:"Browse",de:"Durchsuchen",cs:"Prohlížet"},"navigation-aboutus":{en:"About Us",de:"Über uns",cs:"O nás"},"navigation-favorites":{en:"My Favorites",de:"Meine Favoriten",cs:"Mé oblíbené"},error:{en:"Hmm.. You don't have saved cars!",de:"Hmm.. Sie haben keine Fahrzeuge gespeichert!",cs:"Hm... Nemáte uložená auta!"},"car-button":{en:"Rent this car",de:"Dieses Auto mieten",cs:"Pronajměte si toto auto."},special:()=>{e.html("");for(const t of x){const a=new P(t);e.append(a.render())}}};$(document).ready((async()=>{b=S;try{await async function(t={}){const a=await $.ajax({url:`/api/cars${location.search}`,type:"GET",data:t});if(x=a.cars,y=a.pages,0===y)return p.text(`WHOO!! We don't have the page ${currentPage}! Sorry!`),void h.showGrid();if(0===a.cars.length)for(const t of a.cars){const a=new Article(t);e.append(a.render())}else h.hide()}({specificCars:localStorage.getItem("savedCars")})}catch(e){console.log("Failed to acess localStorage")}H.init(),d.fadeOut(),$("html").css({overflow:"auto"})}))})();